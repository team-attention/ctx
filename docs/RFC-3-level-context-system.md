# RFC: 3-Level Context System

> CTX í”„ë¡œì íŠ¸ ë°©í–¥ ì „í™˜ ì œì•ˆì„œ
> ì‘ì„±ì¼: 2025-12-29
> ì‘ì„±ì: Claude (Opus 4.5)
> ìµœì¢… ìˆ˜ì •: 2026-01-02 (Load ë‹¨ìˆœí™” - keyword search ì œê±°, Hook Script ì—­í•  ë¶„ë¦¬)

---

## 1. ë°°ê²½ ë° ë¬¸ì œ ì •ì˜

### í˜„ì¬ ìƒí™© (As-Is)

CTXëŠ” "íŒ€ ë‹¨ìœ„ ê°œë°œ í˜‘ì—… í”Œë«í¼"ìœ¼ë¡œ ì„¤ê³„ë˜ì—ˆìœ¼ë‚˜, ì‹¤ì œ ì‚¬ìš© ê²½í—˜ì—ì„œ ë‹¤ìŒ ë¬¸ì œë“¤ì´ ë°œê²¬ë¨:

#### ê³¼ì‰ ì„¤ê³„ (Over-Engineering)
```
src/templates/ai-commands/work/   # âŒ ì œê±° ëŒ€ìƒ
â”œâ”€â”€ init.md      # ì´ìŠˆ ì´ˆê¸°í™” (GitHub/Linear/Local ë¶„ê¸°)
â”œâ”€â”€ plan.md      # êµ¬í˜„ ê³„íš
â”œâ”€â”€ extract.md   # ì»¨í…ìŠ¤íŠ¸ ì¶”ì¶œ
â”œâ”€â”€ review.md    # ì½”ë“œ ë¦¬ë·°
â”œâ”€â”€ commit.md    # ì»¤ë°‹
â”œâ”€â”€ submit.md    # PR ìƒì„±
â””â”€â”€ done.md      # ì™„ë£Œ

+ issue_store: local | github-issue | linear  # âŒ ì œê±°
+ worktree ì§€ì›                                # âŒ ì œê±°
+ session tracking hooks                       # ë‹¨ìˆœí™”
```

#### ì‚¬ìš© íŒ¨í„´ê³¼ ì„¤ê³„ ì˜ë„ì˜ ê´´ë¦¬

| ì„¤ê³„ ì˜ë„ | ì‹¤ì œ ì‚¬ìš© |
|-----------|-----------|
| í”¼ì²˜ë³„ ë¸Œëœì¹˜ + PR + ë¦¬ë·° | í•œ ë¸Œëœì¹˜ì—ì„œ ì—¬ëŸ¬ í”¼ì²˜ |
| íŒ€ì›ê°„ ì»¨í…ìŠ¤íŠ¸ ê³µìœ  | í˜¼ìë¼ì„œ ê³µìœ í•  ëŒ€ìƒ ì—†ìŒ |
| ì´ìŠˆ ê¸°ë°˜ ì›ìì  ì‘ì—… | work ë‹¨ìœ„ê°€ ë¹„ëŒ€í•´ì§ |
| ì„¸ì…˜ë§ˆë‹¤ ì»¨í…ìŠ¤íŠ¸ ì¶”ì¶œ | ê¹Œë¨¹ê±°ë‚˜ í•„ìš”ì„± ëª» ëŠë‚Œ |

#### í•µì‹¬ ë¬¸ì œ
- **"ì‚¬ìš©í•˜ê²Œ ë§Œë“œëŠ” í˜"ì´ ì•½í•¨**
- ì›Œí¬í”Œë¡œìš°ê°€ ë¬´ê±°ì›Œì„œ ê±´ë„ˆë›°ê²Œ ë¨
- ì»¨í…ìŠ¤íŠ¸ê°€ ìë™ìœ¼ë¡œ í™œìš©ë˜ì§€ ì•ŠìŒ
- ì €ì¥/ì¶”ì¶œì˜ íƒ€ì´ë°ì´ ì• ë§¤í•¨

---

## 2. ì œì•ˆ: 3-Level Context System

### ë°©í–¥ ì „í™˜
- **ê°œë°œ í˜‘ì—… ë„êµ¬ â†’ ë²”ìš© ì»¨í…ìŠ¤íŠ¸ ê´€ë¦¬ í”Œë«í¼**
- **ìˆ˜ë™ ë¡œë“œ â†’ ìë™ ì£¼ì…**
- **ë³µì¡í•œ ì›Œí¬í”Œë¡œìš° â†’ ë‹¨ìˆœí•œ í•µì‹¬ ê¸°ëŠ¥ë§Œ**
- **ë¶„ì‚° Registry â†’ í•˜ì´ë¸Œë¦¬ë“œ Registry** (ê°œì¸ + íŒ€ í˜‘ì—… ëª¨ë‘ ì§€ì›)
- **config.yaml ì œê±° â†’ registry.yaml ë‹¨ì¼í™”** (ì„¤ì • ìµœì†Œí™”)

### Level êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    3-Level Hierarchy                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Global (~/.ctx/)                           [í•„ìˆ˜, Root]    â”‚
â”‚  â””â”€ ì‚¬ìš©ì ì „ì—­, ëª¨ë“  í”„ë¡œì íŠ¸ì—ì„œ ì°¸ì¡°                    â”‚
â”‚  â””â”€ ê°œì¸ ì½”ë”© ìŠ¤íƒ€ì¼, ë²”ìš© ì§€ì‹, ë„êµ¬ ì‚¬ìš©ë²• ë“±            â”‚
â”‚  â””â”€ ctx init ìœ¼ë¡œ ìµœì´ˆ 1íšŒ ìƒì„±                            â”‚
â”‚  â””â”€ registry.yamlë§Œ ì¡´ì¬ (config ì—†ìŒ!)                    â”‚
â”‚  â””â”€ Git: âŒ (ê°œì¸ ë¨¸ì‹  ì¢…ì†)                               â”‚
â”‚                                                             â”‚
â”‚       â†“ Load ì‹œ í•¨ê»˜ íƒìƒ‰                                   â”‚
â”‚                                                             â”‚
â”‚  Project ({project}/.ctx/)                                  â”‚
â”‚  â””â”€ í”„ë¡œì íŠ¸ ë‹¨ìœ„ ì»¨í…ìŠ¤íŠ¸                                 â”‚
â”‚  â””â”€ ì•„í‚¤í…ì²˜, API íŒ¨í„´, ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë“±                   â”‚
â”‚  â””â”€ ctx init . ìœ¼ë¡œ ìƒì„±                                   â”‚
â”‚  â””â”€ registry.yamlë§Œ ì¡´ì¬ (config ì—†ìŒ!)                    â”‚
â”‚  â””â”€ Git: âœ… (íŒ€ í˜‘ì—… ì§€ì›)                                 â”‚
â”‚                                                             â”‚
â”‚       â†“ ìƒì†/ì˜¤ë²„ë¼ì´ë“œ                                     â”‚
â”‚                                                             â”‚
â”‚  Local (*.ctx.md, ctx.md)                                   â”‚
â”‚  â””â”€ íŠ¹ì • íŒŒì¼/í´ë”ì— ë¶™ì€ ì»¨í…ìŠ¤íŠ¸                         â”‚
â”‚  â””â”€ src/api.ctx.md â†’ src/api.ts ì „ìš©                       â”‚
â”‚  â””â”€ src/utils/ctx.md â†’ src/utils/ í´ë” ì „ìš©                â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ìš°ì„ ìˆœìœ„: Local > Project > Global (ë” êµ¬ì²´ì ì¸ ê²Œ ìš°ì„ )
```

### ë””ë ‰í† ë¦¬ êµ¬ì¡°

#### Global (~/.ctx/) - í•„ìˆ˜, Root, Git âŒ
```
~/.ctx/
â”œâ”€â”€ registry.yaml            # Global context + ì „ì—­ ê²€ìƒ‰ ì¸ë±ìŠ¤ (ìœ ì¼í•œ íŒŒì¼!)
â””â”€â”€ contexts/                # ì „ì—­ ì»¨í…ìŠ¤íŠ¸ (ê°œì¸ìš©)
    â”œâ”€â”€ coding-style.md      # ë‚´ ì½”ë”© ìŠ¤íƒ€ì¼
    â”œâ”€â”€ git-workflow.md      # Git ì‚¬ìš© íŒ¨í„´
    â”œâ”€â”€ typescript.md        # TS ì„ í˜¸ íŒ¨í„´
    â””â”€â”€ tools/
        â”œâ”€â”€ docker.md
        â””â”€â”€ aws.md
```

#### Project ({project}/.ctx/) - Git âœ… (íŒ€ ê³µìœ )
```
my-project/
â”œâ”€â”€ .ctx/
â”‚   â”œâ”€â”€ registry.yaml        # â­ Project/Local context (Git ê´€ë¦¬!) - ìœ ì¼í•œ íŒŒì¼!
â”‚   â””â”€â”€ contexts/            # í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸
â”‚       â”œâ”€â”€ architecture.md
â”‚       â”œâ”€â”€ api-patterns.md
â”‚       â””â”€â”€ business/
â”‚           â””â”€â”€ user-flow.md
â”œâ”€â”€ docs/                    # ctx add docs/**/*.md ë¡œ ë“±ë¡ ê°€ëŠ¥
â”‚   â””â”€â”€ api-guide.md
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ api.ts
â”‚   â”œâ”€â”€ api.ctx.md           # â† Local: api.ts ì „ìš©
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ ctx.md           # â† Local: utils/ í´ë” ì „ìš©
â”‚       â””â”€â”€ helpers.ts
â””â”€â”€ ...
```

#### Local (*.ctx.md)
```
# íŒŒì¼ ì»¨í…ìŠ¤íŠ¸
src/api.ts        â†â†’  src/api.ctx.md
src/auth/login.ts â†â†’  src/auth/login.ctx.md

# í´ë” ì»¨í…ìŠ¤íŠ¸
src/utils/        â†â†’  src/utils/ctx.md
src/components/   â†â†’  src/components/ctx.md
```

---

## 3. í•µì‹¬ ê¸°ëŠ¥ ìš°ì„ ìˆœìœ„

### Load > Save > Sync

#### 1ìˆœìœ„: Load (ì»¨í…ìŠ¤íŠ¸ ì£¼ì…)

**í˜„ì¬ ë¬¸ì œ**: ì»¨í…ìŠ¤íŠ¸ê°€ ìˆì–´ë„ ì ì‹œì— ë¡œë“œë˜ì§€ ì•ŠìŒ

**í•´ê²°ì±…**: Claude Code Hookì„ í™œìš©í•œ ìë™ ì£¼ì…

**Autoload í•µì‹¬ ì›ì¹™**:
- **Path ê¸°ë°˜, Programmatic** - target í•„ë“œë¡œ ë§¤ì¹­
- **í˜„ì¬ Project ê¸°ì¤€** - Root indexëŠ” ì‚¬ìš© ì•ˆ í•¨ (status --all ìš©)

**Autoload ìš°ì„ ìˆœìœ„**:
```
Read("src/api.ts") í˜¸ì¶œ
  â”‚
  â”‚  â€» target ì—†ëŠ” contextëŠ” Autoload ëŒ€ìƒ ì•„ë‹˜
  â”‚
  â”œâ”€ Tier 1: Exact Match (ë†’ì€ ìš°ì„ ìˆœìœ„)
  â”‚   â”œâ”€ 1ìˆœìœ„: Project registry - exact match
  â”‚   â”‚         target: "src/api.ts" â†’ ì •í™•íˆ ì¼ì¹˜
  â”‚   â””â”€ 2ìˆœìœ„: Global registry - exact match
  â”‚
  â””â”€ Tier 2: Glob Match (ë‚®ì€ ìš°ì„ ìˆœìœ„)
      â”œâ”€ 3ìˆœìœ„: Project registry - glob match
      â”‚         target: "src/**/*.ts" â†’ íŒ¨í„´ ë§¤ì¹­
      â””â”€ 4ìˆœìœ„: Global registry - glob match
```

**ì˜ˆì‹œ**:
```yaml
# Project registry
contexts:
  'src/api.ctx.md':
    target: 'src/api.ts'           # exact â†’ 1ìˆœìœ„
  '.ctx/contexts/ts-patterns.md':
    target: 'src/**/*.ts'          # glob  â†’ 3ìˆœìœ„

# Global registry
contexts:
  '~/.ctx/contexts/api-style.md':
    target: '**/api.ts'            # glob  â†’ 4ìˆœìœ„ (Global)
```

**ë™ì‘ ë°©ì‹**:
```
1. cwdì—ì„œ ìœ„ë¡œ íƒìƒ‰ â†’ .ctx/registry.yaml ì°¾ê¸° (í˜„ì¬ Project)

2. Registry ì½ê¸° + target ë§¤ì¹­
   â”œâ”€ Project registryì˜ contexts
   â”‚   - target ìˆëŠ” ê²ƒë§Œ ì¶”ì¶œ
   â”‚   - ì½ì€ íŒŒì¼ê³¼ exact/glob ë§¤ì¹­ ì²´í¬
   â”‚
   â””â”€ Global registryì˜ contexts
       - target ìˆëŠ” ê²ƒë§Œ ì¶”ì¶œ
       - ì½ì€ íŒŒì¼ê³¼ exact/glob ë§¤ì¹­ ì²´í¬

3. ìš°ì„ ìˆœìœ„ëŒ€ë¡œ ì •ë ¬í•˜ì—¬ ë¡œë“œ
   1ìˆœìœ„: Project exact â†’ 2ìˆœìœ„: Global exact
   3ìˆœìœ„: Project glob  â†’ 4ìˆœìœ„: Global glob
```

**íŠ¸ë¦¬ê±°**: PostToolUse(Read) Hook â†’ Hook Script â†’ `ctx load --file`
- íŒŒì¼ ì½ì„ ë•Œë§ˆë‹¤ Hook ì‹¤í–‰
- CLIëŠ” ë§¤ì¹­ëœ context **ê²½ë¡œ/ë©”íƒ€ë°ì´í„°ë§Œ ë°˜í™˜** (ë‚´ìš© X)
- Hook Scriptê°€ ì‹¤ì œ íŒŒì¼ ì½ê¸° + ì¡°í•© ë‹´ë‹¹
- `hookSpecificOutput.additionalContext`ë¡œ ì£¼ì…

#### 2ìˆœìœ„: Save (ì»¨í…ìŠ¤íŠ¸ ì €ì¥)

**í˜„ì¬ ë¬¸ì œ**: ì–¸ì œ/ë¬´ì—‡ì„ ì €ì¥í•´ì•¼ í•˜ëŠ”ì§€ ì• ë§¤í•¨

**í•´ê²°ì±…**: CLI + Skill í˜‘ì—… ë°©ì‹ (â†’ Section 10 ìƒì„¸)

#### 3ìˆœìœ„: Sync (ê²€ì¦ & ìµœì‹ í™”)

**í˜„ì¬ ë¬¸ì œ**: syncê°€ íŒŒì¼ ë³€ê²½ ê°ì§€ì—ë§Œ ì§‘ì¤‘

**í•´ê²°ì±…**: í•˜ì´ë¸Œë¦¬ë“œ Registry ë™ê¸°í™” + ìë™ Global Index ì—…ë°ì´íŠ¸

```bash
# ê¸°ë³¸ ë™ì‘ (ìŠ¤ë§ˆíŠ¸ fallback)
ctx sync                    # Project ìˆìœ¼ë©´ Project sync
                           # Project ì—†ìœ¼ë©´ ìë™ìœ¼ë¡œ Global sync (ê²½ê³  í‘œì‹œ)

# ëª…ì‹œì  Global ë™ê¸°í™”
ctx sync --global           # ~/.ctx/registry.yaml ë™ê¸°í™”

# ì „ì—­ ì¸ë±ìŠ¤ ê°•ì œ ì¬ë¹Œë“œ (ë³µêµ¬ìš©)
ctx sync --rebuild-index    # ëª¨ë“  í”„ë¡œì íŠ¸ ìŠ¤ìº”í•˜ì—¬ index ì¬êµ¬ì¶•

# í—¬ìŠ¤ ì²´í¬
ctx check                   # í—¬ìŠ¤ ì²´í¬
ctx check --strict          # frontmatter í•„ìˆ˜ ê²€ì¦
```

**Sync ê¸°ë³¸ ë™ì‘** (Project ì—†ëŠ” ê³³ì—ì„œ ì‹¤í–‰ ì‹œ):
```
$ ctx sync
âš ï¸ No project found in current directory
âœ“ Synced global registry (~/.ctx/registry.yaml)

ğŸ’¡ To create a project here: ctx init .
```

**Sync í”Œë¡œìš°** (Project ë‚´ì—ì„œ ì‹¤í–‰):
```
ctx sync (í”„ë¡œì íŠ¸ ë‚´ì—ì„œ ì‹¤í–‰)
  â”‚
  â”œâ”€ 1. .ctx/registry.yamlì˜ ë“±ë¡ëœ context íŒŒì¼ë“¤ í™•ì¸
  â”‚
  â”œâ”€ 2. ê° íŒŒì¼ì˜ checksum ê³„ì‚°/ë¹„êµ
  â”‚
  â”œâ”€ 3. .ctx/registry.yaml ê°±ì‹  (í”„ë¡œì íŠ¸ registry)
  â”‚     - ë³€ê²½ëœ íŒŒì¼ checksum ì—…ë°ì´íŠ¸
  â”‚     - ì‚­ì œëœ íŒŒì¼ ì œê±° (ë˜ëŠ” ê²½ê³ )
  â”‚     - ìƒˆ íŒŒì¼ì€ ctx addë¡œ ëª…ì‹œì  ì¶”ê°€ í•„ìš”
  â”‚
  â””â”€ 4. â­ Global index ìë™ ì—…ë°ì´íŠ¸ (í•­ìƒ!)
        â†’ ~/.ctx/registry.yamlì˜ index ì„¹ì…˜ì—
        â†’ í˜„ì¬ í”„ë¡œì íŠ¸ ì •ë³´ ê°±ì‹  (context_count, ìš”ì•½ ë“±)
```

**ì™œ Global Indexë¥¼ ìë™ ì—…ë°ì´íŠ¸í•˜ëŠ”ê°€?**
- ì „ì—­ ì¡°íšŒ(`ctx status --all`)ì˜ ì‹ ë¢°ì„± ë³´ì¥
- "ëª¨ë“  contextë¥¼ ì•„ëŠ” ë³¸ì²´"ê°€ í•„ìš”
- Lazy updateëŠ” ì¡°íšŒ ì‹œ ëŠë ¤ì§ â†’ ë¯¸ë¦¬ ê°±ì‹ ì´ íš¨ìœ¨ì 

**Context ë“±ë¡ ë°©ì‹** (config íŒ¨í„´ ìŠ¤ìº” ëŒ€ì‹  ëª…ì‹œì  ë“±ë¡):
```bash
# ê°œë³„ íŒŒì¼ ë“±ë¡
ctx add src/api.ctx.md

# glob íŒ¨í„´ìœ¼ë¡œ ì¼ê´„ ë“±ë¡
ctx add docs/**/*.md
ctx add **/*.ctx.md

# ë“±ë¡ í•´ì œ
ctx remove test/*.ctx.md
```

---

## 4. Context ì†Œì† ê²°ì • ê·œì¹™

### í•µì‹¬ ì›ì¹™

**ëª¨ë“  context íŒŒì¼ì€ ë°˜ë“œì‹œ ì–´ë”˜ê°€ì— ì†Œì†ë˜ë©°, í•´ë‹¹ registryì— ë“±ë¡ëœë‹¤.**

```
context íŒŒì¼ ìœ„ì¹˜ì—ì„œ ìœ„ë¡œ íƒìƒ‰ â†’ ì²« ë²ˆì§¸ .ctx/registry.yaml ë°œê²¬
â†’ ê·¸ Projectì— ì†Œì† â†’ Project registryì— ë“±ë¡
â†’ ëª» ì°¾ìœ¼ë©´ Globalì— ì†Œì† â†’ Global registryì— ë“±ë¡
```

### Context ì†Œì† ê²°ì • í”Œë¡œìš°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Context Ownership Detection                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  íŒŒì¼: ~/projects/myapp/src/api.ctx.md                     â”‚
â”‚                                                             â”‚
â”‚  1. í˜„ì¬ ë””ë ‰í† ë¦¬ë¶€í„° ìœ„ë¡œ íƒìƒ‰                             â”‚
â”‚                                                             â”‚
â”‚     ~/projects/myapp/src/                                  â”‚
â”‚        â””â”€ .ctx/registry.yaml? âŒ                            â”‚
â”‚                                                             â”‚
â”‚     ~/projects/myapp/                   â† Project ë°œê²¬!    â”‚
â”‚        â””â”€ .ctx/registry.yaml? âœ…                            â”‚
â”‚                                                             â”‚
â”‚  ê²°ê³¼: "projects/myapp" Projectì— ì†Œì†                     â”‚
â”‚        â†’ ~/projects/myapp/.ctx/registry.yamlì— ë“±ë¡        â”‚
â”‚        â†’ Gitìœ¼ë¡œ íŒ€ê³¼ ê³µìœ ë¨ âœ…                            â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  íŒŒì¼: ~/pg/hello.pdf.ctx.md  (project init ì•ˆ í•œ ê³³)      â”‚
â”‚                                                             â”‚
â”‚  1. í˜„ì¬ ë””ë ‰í† ë¦¬ë¶€í„° ìœ„ë¡œ íƒìƒ‰                             â”‚
â”‚                                                             â”‚
â”‚     ~/pg/                                                   â”‚
â”‚        â””â”€ .ctx/registry.yaml? âŒ                            â”‚
â”‚                                                             â”‚
â”‚     ~/                                                      â”‚
â”‚        â””â”€ .ctx/registry.yaml? âœ… (Global)                  â”‚
â”‚                                                             â”‚
â”‚  ê²°ê³¼: Globalì— ì†Œì†                                       â”‚
â”‚        â†’ ~/.ctx/registry.yamlì— ë“±ë¡                       â”‚
â”‚        â†’ ê°œì¸ìš© (Git ë¯¸ê´€ë¦¬)                               â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì†Œì† ê²°ì • ë° Registry ë“±ë¡ ì•Œê³ ë¦¬ì¦˜

```typescript
interface OwnerInfo {
  projectPath: string | null;  // nullì´ë©´ Global
  registryPath: string;        // registry.yaml ê²½ë¡œ
}

function findOwnerAndRegistry(contextFilePath: string): OwnerInfo {
  let dir = path.dirname(contextFilePath);
  const home = os.homedir();

  while (dir !== '/' && dir !== home) {
    const registryPath = path.join(dir, '.ctx', 'registry.yaml');
    if (fs.existsSync(registryPath)) {
      // Project ë°œê²¬ â†’ Project registryì— ë“±ë¡
      return {
        projectPath: dir,
        registryPath
      };
    }
    dir = path.dirname(dir);
  }

  // Global ì†Œì† â†’ Global registryì— ë“±ë¡
  return {
    projectPath: null,
    registryPath: path.join(home, '.ctx', 'registry.yaml')
  };
}
```

### Global = ~ (Home) Root

```
~/.ctx/registry.yaml ì—†ìŒ?
â†’ ì—ëŸ¬: "Run 'ctx init' first to initialize global context"

ê²½ë¡œ ì €ì¥ ê·œì¹™:
- Global registry: ~ ê¸°ì¤€ ìƒëŒ€ê²½ë¡œ
- Project registry: í”„ë¡œì íŠ¸ ë£¨íŠ¸ ê¸°ì¤€ ìƒëŒ€ê²½ë¡œ
```

---

## 5. Config ì—†ëŠ” ì„¤ê³„ (ë‹¨ìˆœí™”)

### ì™œ config.yamlì´ í•„ìš” ì—†ëŠ”ê°€?

ê¸°ì¡´ config.yamlì˜ ì—­í• ê³¼ ëŒ€ì•ˆ:

| ê¸°ì¡´ config ê¸°ëŠ¥ | ìƒˆë¡œìš´ ë°©ì‹ |
|------------------|-------------|
| `contexts.include` íŒ¨í„´ | `ctx add docs/**/*.md` ëª…ì‹œì  ë“±ë¡ |
| `contexts.ignore` íŒ¨í„´ | ë“±ë¡ ì•ˆ í•˜ë©´ ë¨ / `ctx remove` |
| `frontmatter.mode` | `ctx check --strict` CLI ì˜µì…˜ |
| `auto.load` | hook ì„¤ì¹˜ ì—¬ë¶€ë¡œ ê²°ì • |
| `inherit` | ì œê±° (Load ì‹œ í•­ìƒ Globalë„ íƒìƒ‰) |

### ì¥ì 

1. **íŒŒì¼ 1ê°œë¡œ ë‹¨ìˆœí™”** - registry.yamlë§Œ ê´€ë¦¬
2. **ëª…ì‹œì  ë“±ë¡** - ì˜ë„ì¹˜ ì•Šì€ íŒŒì¼ ë“±ë¡ ë°©ì§€
3. **í”„ë¡œì íŠ¸ íŒë‹¨ ë‹¨ìˆœí™”** - `.ctx/registry.yaml` ì¡´ì¬ ì—¬ë¶€ë¡œ íŒë‹¨
4. **ì„¤ì • ì¶©ëŒ ì—†ìŒ** - config ìƒì†/ì˜¤ë²„ë¼ì´ë“œ ë³µì¡ë„ ì œê±°

### í”„ë¡œì íŠ¸ ë§ˆì»¤

```
.ctx/registry.yaml ì¡´ì¬ â†’ ì´ ë””ë ‰í† ë¦¬ê°€ Project Root
~/.ctx/registry.yaml ì¡´ì¬ â†’ Global CTX ì´ˆê¸°í™”ë¨
```

### ìŠ¤ë§ˆíŠ¸ Sync ë™ì‘

Projectê°€ ì—†ëŠ” ë””ë ‰í† ë¦¬ì—ì„œë„ `ctx sync`ê°€ ìì—°ìŠ¤ëŸ½ê²Œ ë™ì‘:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ctx sync ìŠ¤ë§ˆíŠ¸ Fallback                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  í˜„ì¬ ìœ„ì¹˜ì—ì„œ .ctx/registry.yaml íƒìƒ‰                      â”‚
â”‚                                                             â”‚
â”‚  [ë°œê²¬ë¨] â†’ Project sync ì‹¤í–‰                               â”‚
â”‚            + Global index ìë™ ì—…ë°ì´íŠ¸                     â”‚
â”‚                                                             â”‚
â”‚  [ëª» ì°¾ìŒ] â†’ ê²½ê³  í‘œì‹œ + Global sync ì‹¤í–‰                   â”‚
â”‚            "âš ï¸ No project found, syncing global..."        â”‚
â”‚                                                             â”‚
â”‚  âœ… ì–´ë””ì„œë“  syncê°€ ë™ì‘í•¨ (ì—ëŸ¬ ì—†ìŒ)                     â”‚
â”‚  âœ… Project ì—†ì–´ë„ Global context ê´€ë¦¬ ê°€ëŠ¥                â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Global Index ìë™ ì—…ë°ì´íŠ¸

"ëª¨ë“  contextë¥¼ ì•„ëŠ” ë³¸ì²´"ê°€ í•„ìš”í•˜ë¯€ë¡œ, ê´€ë ¨ ëª…ë ¹ì–´ ì‹¤í–‰ ì‹œ Global indexê°€ ìë™ ê°±ì‹ ë¨:

| ëª…ë ¹ì–´ | Global Index ì—…ë°ì´íŠ¸ |
|--------|----------------------|
| `ctx sync` (Project) | âœ… ìë™ |
| `ctx add` | âœ… ìë™ |
| `ctx remove` | âœ… ìë™ |
| `ctx create` | âœ… ìë™ |
| `ctx sync --global` | âŒ (Global contextë§Œ) |
| `ctx sync --rebuild-index` | âœ… ì „ì²´ ì¬ë¹Œë“œ |

### Frontmatter ì—†ëŠ” ë¬¸ì„œ ì²˜ë¦¬

ê¸°ì¡´ docsë¥¼ `ctx add`ë¡œ ë“±ë¡í•  ë•Œ frontmatterê°€ ì—†ëŠ” ê²½ìš°ê°€ ìˆë‹¤. ì´ ê²½ìš° ìë™ ì¶”ì¶œì„ í†µí•´ `what` í•„ë“œë¥¼ ì±„ìš´ë‹¤.

#### ì¶”ì¶œ ìš°ì„ ìˆœìœ„

```
1. frontmatterì˜ what í•„ë“œ (ìˆìœ¼ë©´ ê·¸ëŒ€ë¡œ ì‚¬ìš©)
2. ì²« ë²ˆì§¸ # heading (ë§ˆí¬ë‹¤ìš´ ë¬¸ì„œ)
3. íŒŒì¼ëª… humanize (api-guide.md â†’ "Api Guide")
```

#### ì˜ˆì‹œ

**Frontmatter ìˆëŠ” ê²½ìš°:**
```markdown
---
what: "API ì¸ì¦ ê°€ì´ë“œ"
---
# Authentication
...
```
â†’ `what: "API ì¸ì¦ ê°€ì´ë“œ"` (frontmatter ìš°ì„ )

**Frontmatter ì—†ëŠ” ê²½ìš°:**
```markdown
# API Authentication Guide

This document explains...
```
â†’ `what: "API Authentication Guide"` (headingì—ì„œ ì¶”ì¶œ)

**Headingë„ ì—†ëŠ” ê²½ìš°:**
```markdown
This is a plain text document...
```
â†’ `what: "Api Guide"` (íŒŒì¼ëª… `api-guide.md`ì—ì„œ ì¶”ì¶œ)

#### CLI ì¶œë ¥

```bash
$ ctx add docs/**/*.md
âœ“ docs/api-guide.md (what: "API Authentication Guide")
âœ“ docs/setup.md (what: "Setup")  # íŒŒì¼ëª… fallback
âœ“ docs/architecture.md (what: "ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜")  # frontmatter
Added 3 contexts

# strict ëª¨ë“œë¡œ ê²€ì¦ ì‹œ
$ ctx check --strict
âœ— docs/setup.md: missing frontmatter (what was auto-extracted)
  Run: ctx add --with-frontmatter docs/setup.md
```

#### ì¥ì 

1. **ê¸°ì¡´ ë¬¸ì„œ ì¦‰ì‹œ ë“±ë¡** - frontmatter ì—†ì–´ë„ ë°”ë¡œ ì‚¬ìš© ê°€ëŠ¥
2. **ì ì§„ì  ê°œì„ ** - ë‚˜ì¤‘ì— frontmatter ì¶”ê°€í•´ë„ ë¨
3. **ì˜ˆì¸¡ ê°€ëŠ¥** - ì¶”ì¶œ ê·œì¹™ì´ ëª…í™•í•¨

---

## 6. í•˜ì´ë¸Œë¦¬ë“œ Registry

### í•µì‹¬ ì„¤ê³„: ê°œì¸ + íŒ€ í˜‘ì—… ëª¨ë‘ ì§€ì›

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   í•˜ì´ë¸Œë¦¬ë“œ Registry êµ¬ì¡°                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ~/.ctx/registry.yaml           (Global Registry)           â”‚
â”‚  â””â”€ Global context ê´€ë¦¬                                    â”‚
â”‚  â””â”€ ì „ì—­ ê²€ìƒ‰ìš© ì¸ë±ìŠ¤ (ìºì‹œ)                              â”‚
â”‚  â””â”€ Git: âŒ (ê°œì¸ ë¨¸ì‹  ì¢…ì†)                               â”‚
â”‚                                                             â”‚
â”‚  <project>/.ctx/registry.yaml   (Project Registry)          â”‚
â”‚  â””â”€ Project context ê´€ë¦¬                                   â”‚
â”‚  â””â”€ Local context ê´€ë¦¬                                     â”‚
â”‚  â””â”€ Git: âœ… (íŒ€ ê³µìœ )                                      â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Global Registry (~/.ctx/registry.yaml)

```yaml
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Git: âŒ ë¯¸ê´€ë¦¬ (ê°œì¸ ë¨¸ì‹  ì¢…ì†)
# ë‚´ìš©: Global context + ì „ì—­ ê²€ìƒ‰ìš© ì¸ë±ìŠ¤
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
meta:
  version: "1.0.0"
  last_synced: "2025-12-30T10:00:00Z"

# â­ AIê°€ ì €ì¥ ìœ„ì¹˜ íŒë‹¨í•  ë•Œ ì°¸ì¡°
settings:
  context_paths:
    - path: 'contexts/'
      purpose: "ì¼ë°˜ì ì¸ ê°œì¸ ì»¨í…ìŠ¤íŠ¸"
    - path: 'rules/'
      purpose: "ì½”ë”© ê·œì¹™, ìŠ¤íƒ€ì¼ ê°€ì´ë“œ, ë¦°íŠ¸ ë£°"
    - path: 'docs/'
      purpose: "ë¬¸ì„œí™”ëœ ê°€ì´ë“œ, ë ˆí¼ëŸ°ìŠ¤"
    - path: 'tools/'
      purpose: "ë„êµ¬ ì‚¬ìš©ë²•, CLI ì¹˜íŠ¸ì‹œíŠ¸"

contexts:
  # Global contextë§Œ ê´€ë¦¬
  '.ctx/contexts/coding-style.md':
    checksum: abc123
    what: "ê°œì¸ ì½”ë”© ìŠ¤íƒ€ì¼ ê°€ì´ë“œ"

  '.ctx/contexts/tools/docker.md':
    checksum: def456
    what: "Docker ì‚¬ìš© íŒ¨í„´"

# â­ ì „ì—­ ê²€ìƒ‰ìš© ì¸ë±ìŠ¤ (ctx sync ì‹œ ìë™ ì—…ë°ì´íŠ¸!)
index:
  'projects/myapp':
    path: '/Users/me/projects/myapp'      # ì ˆëŒ€ ê²½ë¡œ
    last_synced: "2025-12-31T12:00:00Z"   # ë§ˆì§€ë§‰ sync ì‹œê°„
    context_count: 5
    # ìš”ì•½ ì •ë³´ (status --all í‘œì‹œìš©)
    contexts:
      - path: 'src/api.ctx.md'
        what: "API ë¼ìš°íŒ… ë¡œì§"
      - path: '.ctx/contexts/architecture.md'
        what: "í”„ë¡œì íŠ¸ ì•„í‚¤í…ì²˜"
      - path: 'src/auth/middleware.ctx.md'
        what: "ì¸ì¦ ë¯¸ë“¤ì›¨ì–´"

  'projects/another':
    path: '/Users/me/projects/another'
    last_synced: "2025-12-30T15:00:00Z"
    context_count: 3
    contexts:
      - path: '.ctx/contexts/readme.md'
        what: "í”„ë¡œì íŠ¸ ì†Œê°œ"
```

**Index ìë™ ì—…ë°ì´íŠ¸ ì‹œì :**
- `ctx sync` ì‹¤í–‰ ì‹œ (Project ë‚´ì—ì„œ)
- `ctx add` / `ctx remove` ì‹¤í–‰ ì‹œ
- `ctx create` ì‹¤í–‰ ì‹œ

**Indexì˜ ì—­í• :**
- ì „ì—­ ê²€ìƒ‰ ì‹œ ê° í”„ë¡œì íŠ¸ registry íŒŒì¼ ì—´ì§€ ì•Šì•„ë„ ë¨
- `ctx status --all` í‘œì‹œìš©
- "ëª¨ë“  contextë¥¼ ì•„ëŠ” ë³¸ì²´" ì—­í• 

### Project Registry (<project>/.ctx/registry.yaml)

```yaml
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Git: âœ… ê´€ë¦¬ë¨ (íŒ€ ê³µìœ )
# ë‚´ìš©: Project context + Local context
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
meta:
  version: "1.0.0"
  last_synced: "2025-12-30T10:00:00Z"

# â­ AIê°€ ì €ì¥ ìœ„ì¹˜ íŒë‹¨í•  ë•Œ ì°¸ì¡° (íŒ€ê³¼ ê³µìœ ë¨!)
settings:
  context_paths:
    - path: '.ctx/contexts/'
      purpose: "í”„ë¡œì íŠ¸ ì•„í‚¤í…ì²˜, ì„¤ê³„ ë¬¸ì„œ"
    - path: 'docs/'
      purpose: "API ë¬¸ì„œ, ì‚¬ìš©ì ê°€ì´ë“œ"
    - path: '.ctx/decisions/'
      purpose: "ADR, ê¸°ìˆ  ê²°ì • ê¸°ë¡"

contexts:
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # target ì—†ìŒ â†’ Autoload ëŒ€ìƒ ì•„ë‹˜
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  '.ctx/contexts/architecture.md':
    checksum: xyz789
    what: "í”„ë¡œì íŠ¸ ì•„í‚¤í…ì²˜"

  'docs/api-guide.md':
    checksum: uvw012
    what: "API ê°€ì´ë“œ"

  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # target ìˆìŒ â†’ Autoload ëŒ€ìƒ
  # exact path ë˜ëŠ” glob pattern ê°€ëŠ¥
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  # exact match - src/api.ts ì½ì„ ë•Œë§Œ ë¡œë“œ
  'src/api.ctx.md':
    target: 'src/api.ts'
    checksum: rst345
    what: "API ë¼ìš°íŒ… ë¡œì§"

  # glob pattern - src/**/*.ts ì½ì„ ë•Œ ë¡œë“œ
  '.ctx/contexts/typescript-patterns.md':
    target: 'src/**/*.ts'
    checksum: ghi012
    what: "TypeScript íŒ¨í„´ ê°€ì´ë“œ"

  # glob pattern - í…ŒìŠ¤íŠ¸ íŒŒì¼ ì½ì„ ë•Œ ë¡œë“œ
  '.ctx/contexts/test-guide.md':
    target: '**/*.test.ts'
    checksum: jkl345
    what: "í…ŒìŠ¤íŠ¸ ì‘ì„± ê°€ì´ë“œ"

  # folder target - src/utils/ ì•„ë˜ íŒŒì¼ ì½ì„ ë•Œ ë¡œë“œ
  'src/utils/ctx.md':
    target: 'src/utils/'
    checksum: abc789
    what: "ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤"
```

### ì €ì¥ ìœ„ì¹˜ ê²°ì • ê·œì¹™

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Save Location Decision                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  /ctx.save ì‹¤í–‰ ì‹œ scope ì„ íƒ                               â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Scope       â”‚ íŒŒì¼ ì €ì¥ ìœ„ì¹˜    â”‚ Registry ìœ„ì¹˜         â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ Global      â”‚ ~/.ctx/contexts/ â”‚ ~/.ctx/registry.yaml  â”‚ â”‚
â”‚  â”‚ Project     â”‚ <proj>/.ctx/     â”‚ <proj>/.ctx/reg.yaml  â”‚ â”‚
â”‚  â”‚ Local       â”‚ <file>.ctx.md    â”‚ <proj>/.ctx/reg.yaml  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  * Local/Project â†’ í”„ë¡œì íŠ¸ registry (Git ê³µìœ ë¨)          â”‚
â”‚  * Global â†’ ê¸€ë¡œë²Œ registry (ê°œì¸ìš©)                       â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì¡°íšŒ ìš°ì„ ìˆœìœ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Load Priority                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Autoload (target ë§¤ì¹­ ì‹œ):                                 â”‚
â”‚                                                             â”‚
â”‚  1ìˆœìœ„: Project registry - exact match                      â”‚
â”‚  2ìˆœìœ„: Global registry - exact match                       â”‚
â”‚  3ìˆœìœ„: Project registry - glob match                       â”‚
â”‚  4ìˆœìœ„: Global registry - glob match                        â”‚
â”‚                                                             â”‚
â”‚  * target í•„ë“œê°€ ìˆëŠ” contextë§Œ Autoload ëŒ€ìƒ              â”‚
â”‚  * ë” êµ¬ì²´ì ì¸ ë§¤ì¹­(exact)ì´ ìš°ì„                           â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Registry í•„ë“œ ê·œì¹™

| ìœ„ì¹˜ | í•„ë“œ | ì˜ë¯¸ |
|------|------|------|
| Global registry | - | Global context |
| Project registry | `target` âŒ | Project context |
| Project registry | `target` âœ… | Local context (companion) |

### Settings ìŠ¤í‚¤ë§ˆ

```yaml
settings:
  context_paths:              # AIê°€ ì €ì¥ ìœ„ì¹˜ íŒë‹¨í•  ë•Œ ì°¸ì¡°
    - path: string            # ìƒëŒ€ ê²½ë¡œ (registry ê¸°ì¤€)
      purpose: string         # ì´ ê²½ë¡œì˜ ìš©ë„ ì„¤ëª… (AI íŒë‹¨ìš©)
```

**ìš©ë„**:
- AI Skillì´ "ì–´ë””ì— ì €ì¥í• ì§€" íŒë‹¨í•  ë•Œ `purpose`ë¥¼ ì°¸ê³ 
- `ctx create` ì‹œ ê²½ë¡œ ì„ íƒì§€ë¡œ ì œì‹œ
- íŒ€ í”„ë¡œì íŠ¸ì—ì„œ context ì €ì¥ ìœ„ì¹˜ í‘œì¤€í™”

**AI íŒë‹¨ íë¦„ ì˜ˆì‹œ**:
```
ì‚¬ìš©ì: "typescript rule ì €ì¥í•´ì¤˜"

AI ë¶„ì„:
  1. scope ê²°ì •: Global (ê°œì¸ ì½”ë”© ìŠ¤íƒ€ì¼)
  2. ~/.ctx/registry.yamlì˜ settings.context_paths í™•ì¸
  3. "rule" í‚¤ì›Œë“œ â†’ purpose: "ì½”ë”© ê·œì¹™..." ë§¤ì¹­
  4. â†’ ~/.ctx/rules/typescript.md ì¶”ì²œ
  5. ctx create --path rules/ typescript.md ì‹¤í–‰
```

**ê¸°ë³¸ê°’** (ctx init ì‹œ ìƒì„±):
```yaml
# Global (~/.ctx/registry.yaml)
settings:
  context_paths:
    - path: 'contexts/'
      purpose: "ì¼ë°˜ì ì¸ ê°œì¸ ì»¨í…ìŠ¤íŠ¸"

# Project (.ctx/registry.yaml)
settings:
  context_paths:
    - path: '.ctx/contexts/'
      purpose: "í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸"
```

**Interactive í”Œë¡œìš°** (ctx init ì‹œ):
```
$ ctx init .

ğŸ“¦ Initializing project context...

Where do you want to store contexts?
  Default: .ctx/contexts/

Add context paths (path:purpose, empty to finish):
  [1] .ctx/contexts/ : í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸ (default)
  [2] > docs/ : API ë¬¸ì„œ
  [3] > .ctx/decisions/ : ADR, ê¸°ìˆ  ê²°ì •
  [4] >

âœ“ Created .ctx/registry.yaml
  Paths:
    - .ctx/contexts/  â†’ í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸
    - docs/           â†’ API ë¬¸ì„œ
    - .ctx/decisions/ â†’ ADR, ê¸°ìˆ  ê²°ì •
```

**Non-interactive** (AIìš©, --context-paths ì˜µì…˜):
```bash
# AIê°€ í”„ë¡œì íŠ¸ ì´ˆê¸°í™”í•  ë•Œ
ctx init . --context-paths ".ctx/contexts/:í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸,docs/:API ë¬¸ì„œ"
```

### Git ê´€ë¦¬ ì •ì±…

| íŒŒì¼ | Git | ì´ìœ  |
|------|-----|------|
| `~/.ctx/registry.yaml` | âŒ | ê°œì¸ + ìºì‹œ |
| `~/.ctx/contexts/**` | âŒ | ê°œì¸ ì»¨í…ìŠ¤íŠ¸ |
| `<proj>/.ctx/registry.yaml` | âœ… | **íŒ€ ì»¨í…ìŠ¤íŠ¸ ê³µìœ ** |
| `<proj>/.ctx/contexts/**` | âœ… | í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸ |
| `<proj>/**/*.ctx.md` | âœ… | ë¡œì»¬ ì»¨í…ìŠ¤íŠ¸ |

### ì¥ì 

1. **ê°œì¸ + íŒ€ ëª¨ë‘ ì§€ì›** - í˜¼ì ì¨ë„, íŒ€ê³¼ ì¨ë„ OK
2. **Gitìœ¼ë¡œ íŒ€ ê³µìœ ** - ìƒˆ íŒ€ì› ì˜¨ë³´ë”© ì‹œ cloneë§Œ í•˜ë©´ ì»¨í…ìŠ¤íŠ¸ ë°”ë¡œ ì‚¬ìš©
3. **CI/CD ì—°ë™ ê°€ëŠ¥** - í”„ë¡œì íŠ¸ registry ê¸°ë°˜ìœ¼ë¡œ ìë™í™” ê°€ëŠ¥
4. **ì „ì—­ ê²€ìƒ‰ ì§€ì›** - Global registryì˜ index ì„¹ì…˜ í™œìš©
5. **Orphan ì²˜ë¦¬** - í”„ë¡œì íŠ¸ ì—†ëŠ” contextëŠ” Globalì— ë“±ë¡

---

## 7. ë§ˆì´ê·¸ë ˆì´ì…˜ ê³„íš

### ì œê±° ëŒ€ìƒ
```
âŒ src/templates/ai-commands/work/     # ì „ì²´ ì‚­ì œ
   â”œâ”€â”€ init.md
   â”œâ”€â”€ plan.md
   â”œâ”€â”€ extract.md
   â”œâ”€â”€ review.md
   â”œâ”€â”€ commit.md
   â”œâ”€â”€ submit.md
   â””â”€â”€ done.md

âŒ issue_store ê´€ë ¨ ì½”ë“œ              # ì „ì²´ ì‚­ì œ
âŒ worktree ê´€ë ¨ ì½”ë“œ                 # ì „ì²´ ì‚­ì œ
âŒ .ctx.current ê´€ë ¨ ì½”ë“œ             # ì „ì²´ ì‚­ì œ
```

### As-Is â†’ To-Be ë§¤í•‘

| As-Is (í˜„ì¬) | To-Be (ìƒˆ êµ¬ì¡°) |
|--------------|-----------------|
| `ctx/` ë””ë ‰í† ë¦¬ | `.ctx/contexts/` (Project) |
| `**/*.ctx.md` | ë™ì¼ (Local) |
| `ctx.config.yaml` (ë£¨íŠ¸) | **ì œê±°** (config ì—†ìŒ) |
| ì—†ìŒ | `~/.ctx/` (Global Root) |
| `local-context-registry.yml` | `.ctx/registry.yaml` (Project) |
| `global-context-registry.yml` | `~/.ctx/registry.yaml` (Global) |
| `work` ê´€ë ¨ ì „ì²´ | ì‚­ì œ |

### ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸
```bash
ctx migrate

# ìˆ˜í–‰ ë‚´ìš©:
# 1. ~/.ctx/ ì¡´ì¬ í™•ì¸ (ì—†ìœ¼ë©´ ctx init ë¨¼ì € ì‹¤í–‰ ì•ˆë‚´)
# 2. ê¸°ì¡´ ctx/ â†’ .ctx/contexts/ ì´ë™
# 3. ê¸°ì¡´ ctx.config.yaml â†’ ì‚­ì œ (ë” ì´ìƒ í•„ìš” ì—†ìŒ)
# 4. ê¸°ì¡´ local-context-registry.yml â†’ .ctx/registry.yaml (Project)
# 5. ê¸°ì¡´ global-context-registry.yml â†’ ~/.ctx/registry.yaml (Global)
# 6. work ê´€ë ¨ íŒŒì¼ ì‚­ì œ (ë°±ì—… í›„)
# 7. .gitignoreì—ì„œ .ctx/registry.yaml ì œì™¸ í™•ì¸ (Git ê´€ë¦¬ë˜ì–´ì•¼ í•¨)
```

---

## 8. ì»¤ë§¨ë“œ ì¬ì„¤ê³„

### CLI ì»¤ë§¨ë“œ

```bash
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ì´ˆê¸°í™”
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ctx init                    # ~/.ctx/ ìƒì„± (Global Root, ìµœì´ˆ 1íšŒ)
                           # + Claude Code plugin ì„¤ì¹˜ ì•ˆë‚´
                           # Interactive: context_paths ì„¤ì •
ctx init .                  # .ctx/ ìƒì„± (Project - registry.yamlë§Œ!)
                           # Interactive: context_paths ì„¤ì •

# context_paths ì§ì ‘ ì§€ì • (non-interactive, AIìš©)
ctx init --context-paths "contexts/:ì¼ë°˜ ì»¨í…ìŠ¤íŠ¸,rules/:ì½”ë”© ê·œì¹™"
ctx init . --context-paths ".ctx/contexts/:í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸,docs/:API ë¬¸ì„œ"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ì»¨í…ìŠ¤íŠ¸ ë“±ë¡/í•´ì œ (NEW - config ëŒ€ì²´)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ctx add <path>              # context íŒŒì¼ì„ registryì— ë“±ë¡
ctx add docs/**/*.md        # glob íŒ¨í„´ìœ¼ë¡œ ì¼ê´„ ë“±ë¡
ctx add --global <path>     # Global registryì— ë“±ë¡
                           # â­ Global indexë„ ìë™ ì—…ë°ì´íŠ¸!

ctx remove <path>           # registryì—ì„œ ë“±ë¡ í•´ì œ
ctx remove docs/old/**      # glob íŒ¨í„´ìœ¼ë¡œ ì¼ê´„ í•´ì œ
                           # â­ Global indexë„ ìë™ ì—…ë°ì´íŠ¸!

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ì»¨í…ìŠ¤íŠ¸ ìƒì„± (í…œí”Œë¦¿ ê¸°ë°˜)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ctx create <target>         # Local context ìƒì„± â†’ registry ë“±ë¡ â†’ Global index ê°±ì‹ 
ctx create --project <name> # Project context ìƒì„± â†’ registry ë“±ë¡ â†’ Global index ê°±ì‹ 
ctx create --global <name>  # Global context ìƒì„± â†’ Global registry ë“±ë¡

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ì»¨í…ìŠ¤íŠ¸ ë¡œë“œ (Hookìš©)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ctx load --file <path>      # target ë§¤ì¹­í•˜ì—¬ context ê²½ë¡œ/ë©”íƒ€ë°ì´í„° ë°˜í™˜
                           # ex) ctx load --file src/api.ts
                           # â†’ ë§¤ì¹­ëœ context ëª©ë¡ì„ JSONìœ¼ë¡œ ì¶œë ¥
                           # â†’ ìš°ì„ ìˆœìœ„: Project exact > Global exact > Project glob > Global glob

ctx load --file <path> --json   # JSON í˜•ì‹ ì¶œë ¥ (ê¸°ë³¸ê°’)
ctx load --file <path> --paths  # ê²½ë¡œë§Œ ì¶œë ¥ (ì¤„ë°”ê¿ˆ êµ¬ë¶„)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ë™ê¸°í™” & ê²€ì¦
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ctx sync                    # ìŠ¤ë§ˆíŠ¸ ë™ì‘:
                           #   Project ìˆìŒ â†’ Project sync + Global index ìë™ ê°±ì‹ 
                           #   Project ì—†ìŒ â†’ Global sync (ê²½ê³  í‘œì‹œ)
ctx sync --global           # Global registryë§Œ ë™ê¸°í™”
ctx sync --rebuild-index    # Global index ê°•ì œ ì¬ë¹Œë“œ (ë³µêµ¬/ì´ˆê¸°í™”ìš©)

ctx check                   # í—¬ìŠ¤ ì²´í¬ (íŒŒì¼ ì¡´ì¬, checksum ì¼ì¹˜)
ctx check --strict          # frontmatter í•„ìˆ˜ ê²€ì¦ (ê¸°ì¡´ configì˜ ì—­í• )

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ìƒíƒœ í™•ì¸
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ctx status                  # í˜„ì¬ í”„ë¡œì íŠ¸ context ìƒíƒœ + context_paths í‘œì‹œ
ctx status --global         # Global contextë§Œ (Global registry)
ctx status --all            # ì „ì²´ (index ê¸°ë°˜)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ë§ˆì´ê·¸ë ˆì´ì…˜
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ctx migrate                 # ê¸°ì¡´ êµ¬ì¡° â†’ ìƒˆ êµ¬ì¡° ë³€í™˜
```

### AI Commands (Claude Code Skills)

```
/ctx.save [message]         # í†µí•© Save Skill (source ë¶„ê¸° ì²˜ë¦¬)
                           # - ê¸°ë³¸: ìì—°ì–´ ì…ë ¥
                           # - --from session: Claude Code ì„¸ì…˜ì—ì„œ ì¶”ì¶œ
                           # - --from slack: Slack ì±„ë„/ìŠ¤ë ˆë“œì—ì„œ ì¶”ì¶œ (MCP)
                           # - --from url: ì›¹í˜ì´ì§€ì—ì„œ ì¶”ì¶œ
                           # - --from clipboard: í´ë¦½ë³´ë“œì—ì„œ ì¶”ì¶œ
                           # â†’ Skillì´ scope ì œì•ˆ â†’ CLI create â†’ ë‚´ìš© ì‘ì„±

/ctx.load [keywords...]     # ì»¨í…ìŠ¤íŠ¸ ì¡°íšŒ/ë¡œë“œ Skill
                           # - ìì—°ì–´: "ì¸ì¦ ê´€ë ¨ ì»¨í…ìŠ¤íŠ¸ ì°¾ì•„ì¤˜"
                           # - í‚¤ì›Œë“œ: /ctx.load auth jwt
                           # â†’ ctx statusë¡œ ëª©ë¡ í™•ì¸ â†’ what í•„ë“œë¡œ íŒë‹¨ â†’ Read

/ctx.sync                   # ctx sync ë˜í¼
/ctx.status                 # ctx status ë˜í¼
```

**ìë™ ë¡œë“œ vs ìˆ˜ë™ ë¡œë“œ**:
- ìë™ ë¡œë“œ: Hookì´ `ctx load --file` í˜¸ì¶œí•˜ì—¬ ì²˜ë¦¬ (íŒŒì¼ ì½ì„ ë•Œ ìë™)
- ìˆ˜ë™ ë¡œë“œ: `/ctx.load` Skillì´ ì‚¬ìš©ì ìš”ì²­ì— ë”°ë¼ context ê²€ìƒ‰/ë¡œë“œ

---

## 9. Plugin êµ¬ì¡°

### ctx repo ë‚´ë¶€ ì„œë¸ŒíŒ¨í‚¤ì§€ë¡œ ê´€ë¦¬

```
ctx/
â”œâ”€â”€ src/                      # CLI ì½”ë“œ
â”‚   â”œâ”€â”€ commands/
â”‚   â”‚   â”œâ”€â”€ init.ts          # ctx init, ctx init .
â”‚   â”‚   â”œâ”€â”€ add.ts           # ctx add (NEW)
â”‚   â”‚   â”œâ”€â”€ remove.ts        # ctx remove (NEW)
â”‚   â”‚   â”œâ”€â”€ create.ts        # ctx create
â”‚   â”‚   â”œâ”€â”€ load.ts          # ctx load (NEW - ìˆ˜ë™/ìë™ ë¡œë“œ)
â”‚   â”‚   â”œâ”€â”€ sync.ts          # ctx sync
â”‚   â”‚   â”œâ”€â”€ check.ts         # ctx check
â”‚   â”‚   â”œâ”€â”€ status.ts        # ctx status
â”‚   â”‚   â””â”€â”€ migrate.ts       # ctx migrate
â”‚   â””â”€â”€ lib/
â”‚       â”œâ”€â”€ registry.ts      # registry ê´€ë¦¬ (config ì—†ìŒ!)
â”‚       â””â”€â”€ loader.ts        # context ë¡œë”©
â”‚
â”œâ”€â”€ plugin/                   # Claude Code Plugin
â”‚   â”œâ”€â”€ .claude-plugin/
â”‚   â”‚   â””â”€â”€ plugin.json
â”‚   â”œâ”€â”€ skills/
â”‚   â”‚   â”œâ”€â”€ save/
â”‚   â”‚   â”‚   â””â”€â”€ SKILL.md     # /ctx.save (í†µí•©: ìì—°ì–´/session/slack/url/clipboard)
â”‚   â”‚   â””â”€â”€ load/
â”‚   â”‚       â””â”€â”€ SKILL.md     # /ctx.load (ì»¨í…ìŠ¤íŠ¸ ì¡°íšŒ/ê²€ìƒ‰/ë¡œë“œ)
â”‚   â”œâ”€â”€ commands/
â”‚   â”‚   â”œâ”€â”€ sync.md          # /ctx.sync (CLI wrapper)
â”‚   â”‚   â””â”€â”€ status.md        # /ctx.status (CLI wrapper)
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”œâ”€â”€ hooks.json                  # PostToolUse(Read) ìë™ ë¡œë“œ
â”‚   â”‚   â””â”€â”€ auto-load-context.sh        # context ë¡œë“œ ìŠ¤í¬ë¦½íŠ¸
â”‚   â””â”€â”€ scripts/
â”‚       â””â”€â”€ auto-load-context.sh        # (hooksì—ì„œ ì°¸ì¡°)
â”‚
â””â”€â”€ package.json
```

### hooks.json ìƒì„¸

Hook Scriptë¥¼ í™œìš©í•œ ìë™ ë¡œë“œ:

```json
{
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Read",
        "hooks": [
          {
            "type": "command",
            "command": "plugin/hooks/auto-load-context.sh",
            "timeout": 5000
          }
        ]
      }
    ]
  }
}
```

**Hook Script** (`plugin/hooks/auto-load-context.sh`):
```bash
#!/bin/bash
# stdinì—ì„œ tool_input ì½ê¸°
input=$(cat)
file_path=$(echo "$input" | jq -r '.tool_input.file_path // empty')

if [ -z "$file_path" ]; then
  exit 0
fi

# CLIë¡œ ë§¤ì¹­ë˜ëŠ” context ê²½ë¡œ ì¡°íšŒ
contexts=$(ctx load --file "$file_path" --json)

if [ -z "$contexts" ] || [ "$contexts" = "[]" ]; then
  exit 0
fi

# ê° context íŒŒì¼ ì½ì–´ì„œ ì¡°í•©
echo "$contexts" | jq -r '.[].path' | while read -r ctx_path; do
  echo "--- $ctx_path ---"
  cat "$ctx_path"
  echo ""
done
```

**ë™ì‘ íë¦„**:
```
1. Claude Codeê°€ Read toolë¡œ íŒŒì¼ ì½ìŒ
2. PostToolUse hook íŠ¸ë¦¬ê±° â†’ Hook Script ì‹¤í–‰
3. Hook Scriptê°€ stdinì—ì„œ file_path ì¶”ì¶œ
4. ctx load --file í˜¸ì¶œ â†’ ë§¤ì¹­ëœ context ê²½ë¡œ/ë©”íƒ€ ë°˜í™˜ (JSON)
5. Hook Scriptê°€ ê° context íŒŒì¼ ì½ì–´ì„œ ì¡°í•©
6. stdoutìœ¼ë¡œ ì¶œë ¥ â†’ additionalContextë¡œ ì£¼ì…
```

**CLI ì¶œë ¥ ì˜ˆì‹œ** (`ctx load --file src/api.ts --json`):
```json
[
  {"path": "src/api.ctx.md", "what": "API ë¼ìš°íŒ… ë¡œì§"},
  {"path": ".ctx/contexts/ts-patterns.md", "what": "TypeScript íŒ¨í„´ ê°€ì´ë“œ"}
]
```

### Plugin ì„¤ì¹˜ ë°©ì‹

```bash
# ctx init ì‹œ ìë™ ì„¤ì¹˜ ì•ˆë‚´
ctx init

# ì¶œë ¥:
# âœ“ Created ~/.ctx/
# âœ“ Created ~/.ctx/registry.yaml
# âœ“ Created ~/.ctx/contexts/
#
# ğŸ“¦ Claude Code Plugin ì„¤ì¹˜:
#   claude plugins install ctx
# ë˜ëŠ” ìˆ˜ë™ìœ¼ë¡œ:
#   ln -s $(npm root -g)/ctx/plugin ~/.claude/plugins/ctx
```

---

## 10. Save íë¦„ ìƒì„¸

### Skill vs Command ê°œë… ì •ë¦¬

Claude Codeì—ì„œ Skillê³¼ CommandëŠ” ë‹¤ë¥¸ ê°œë…:

| êµ¬ë¶„ | Skill | Command |
|------|-------|---------|
| **í˜¸ì¶œ ë°©ì‹** | ìì—°ì–´ â†’ Claudeê°€ ìë™ ì„ íƒ | `/command`ë¡œ ëª…ì‹œì  í˜¸ì¶œ |
| **ë™ì‘** | descriptionê³¼ ìš”ì²­ ë§¤ì¹­ ì‹œ í™œì„±í™” | ì‚¬ìš©ìê°€ ì…ë ¥í•  ë•Œë§Œ ì‹¤í–‰ |
| **êµ¬ì¡°** | SKILL.md + ë¦¬ì†ŒìŠ¤ íŒŒì¼ë“¤ | ë‹¨ì¼ .md íŒŒì¼ |
| **ìš©ë„** | ë³µì¡í•œ ëŠ¥ë ¥ ë¶€ì—¬ | ë¹ ë¥¸ í”„ë¡¬í”„íŠ¸ ì‹¤í–‰ |

**CTX ì„¤ê³„ ì›ì¹™: Skill First**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Skill First êµ¬ì¡°                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Skill (í•µì‹¬)                                               â”‚
â”‚  â””â”€ ctx-save: "ì´ê±° ì €ì¥í•´ì¤˜" ê°™ì€ ìì—°ì–´ì— ìë™ ë°˜ì‘      â”‚
â”‚                                                             â”‚
â”‚  Command (í¸ì˜ìš© Wrapper)                                   â”‚
â”‚  â””â”€ /ctx.save â†’ ctx-save Skill ëª…ì‹œì  í˜¸ì¶œ                 â”‚
â”‚                                                             â”‚
â”‚  Hook (ìë™í™”)                                              â”‚
â”‚  â””â”€ PostToolUse(Read) â†’ ìë™ context ë¡œë“œ                  â”‚
â”‚                                                             â”‚
â”‚  ì‚¬ìš©ì ê²½í—˜:                                               â”‚
â”‚  - ìì—°ì–´ë¡œ ë§í•´ë„ ë¨ ("ì´ ë‚´ìš© ì»¨í…ìŠ¤íŠ¸ë¡œ ì €ì¥í•´")        â”‚
â”‚  - ëª…ì‹œì ìœ¼ë¡œ /ctx.save í•´ë„ ë¨                            â”‚
â”‚  - íŒŒì¼ ì½ìœ¼ë©´ context ìë™ ë¡œë“œë¨                         â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Save ëª¨ë“œ: Quick vs Deliberate

**í•µì‹¬ ë¬¸ì œ**: Saveì˜ ë§ˆì°°ì´ ì‚¬ìš©ë¥ ì„ ê²°ì •í•¨

```
ì €ì¥ì˜ ë§ˆì°° > ì €ì¥ì˜ ì¦‰ê°ì  ë³´ìƒ  â†’  ì‚¬ìš© ì•ˆ í•¨
ì €ì¥ì˜ ë§ˆì°° < ì €ì¥ì˜ ì¦‰ê°ì  ë³´ìƒ  â†’  ì‚¬ìš©í•¨
```

**í•´ê²°ì±…**: ë‘ ê°€ì§€ ëª¨ë“œ ì œê³µ

#### Quick Mode (Zero-Friction)

ëª©ì : ë§ˆì°° ìµœì†Œí™”, ìŠµê´€í™” ë¶ˆí•„ìš”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Quick Save Flow                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  íŠ¸ë¦¬ê±°:                                                    â”‚
â”‚  - "ì´ê±° ì €ì¥í•´ì¤˜" (ìì—°ì–´)                                 â”‚
â”‚  - /ctx.save (ëª…ì‹œì )                                       â”‚
â”‚  - ì„¸ì…˜ ì¢…ë£Œ ì‹œ ìë™ ì œì•ˆ (Passive)                        â”‚
â”‚                                                             â”‚
â”‚  ë™ì‘:                                                      â”‚
â”‚  1. Source: í˜„ì¬ ì„¸ì…˜ (ì•”ë¬µì  ê¸°ë³¸ê°’)                      â”‚
â”‚  2. ì¶”ì¶œ: AIê°€ ìë™ íŒë‹¨                                   â”‚
â”‚  3. ìœ„ì¹˜: AIê°€ ì¶”ì²œ (1ê°œ)                                  â”‚
â”‚  4. í™•ì¸: "ì´ê±° ë§ì£ ?" â†’ Y/n (1íšŒ)                         â”‚
â”‚                                                             â”‚
â”‚  ì‚¬ìš©ì ì…ë ¥: ìµœì†Œ 1íšŒ (Y/n)                               â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Deliberate Mode (ì •êµí•œ ì œì–´)

ëª©ì : ì™¸ë¶€ ì†ŒìŠ¤, ë³µì¡í•œ êµ¬ì¡°í™”, ê¸°ì¡´ ì»¨í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Deliberate Save Flow                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  íŠ¸ë¦¬ê±°:                                                    â”‚
â”‚  - "Slackì—ì„œ ì»¨í…ìŠ¤íŠ¸ ì¶”ì¶œí•´ì¤˜" (ì™¸ë¶€ ì†ŒìŠ¤ ì–¸ê¸‰)          â”‚
â”‚  - "deliberateí•˜ê²Œ ì €ì¥í•˜ê³  ì‹¶ì–´" (ëª…ì‹œì  ìš”ì²­)            â”‚
â”‚                                                             â”‚
â”‚  ë™ì‘:                                                      â”‚
â”‚  1. Source: ì‚¬ìš©ìê°€ ì„ íƒ                                  â”‚
â”‚     - Claude session / Slack / URL / Clipboard / ...       â”‚
â”‚  2. ì¶”ì¶œ: ì‚¬ìš©ìê°€ ë¦¬ë·°/ìˆ˜ì •                               â”‚
â”‚  3. ìœ„ì¹˜: í›„ë³´ Nê°œ ì œì‹œ â†’ ì‚¬ìš©ì ì„ íƒ                      â”‚
â”‚  4. ìƒì„±/ì—…ë°ì´íŠ¸: ì‚¬ìš©ì í™•ì¸                             â”‚
â”‚  5. ë©”íƒ€ë°ì´í„°: í¸ì§‘ ê°€ëŠ¥                                  â”‚
â”‚                                                             â”‚
â”‚  ì‚¬ìš©ì ì…ë ¥: ë‹¨ê³„ë³„ í™•ì¸                                  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Save ì›Œí¬í”Œë¡œìš° íŒŒì´í”„ë¼ì¸ (ê³µí†µ)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Save Pipeline                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  1. Source íƒìƒ‰                                             â”‚
â”‚     â””â”€ Claude session / Slack / URL / Clipboard / ...      â”‚
â”‚                                                             â”‚
â”‚  2. ìœ ì˜ë¯¸í•œ ê²ƒ ì¶”ì¶œ                                        â”‚
â”‚     â””â”€ AI ë¶„ì„ + ì‚¬ìš©ì preference (optional)              â”‚
â”‚                                                             â”‚
â”‚  3. ì €ì¥ ìœ„ì¹˜/ë°©ì‹ ê²°ì •                                     â”‚
â”‚     â””â”€ registry ê¸°ë°˜ìœ¼ë¡œ scope íŒë‹¨                        â”‚
â”‚     â””â”€ ìƒˆë¡œ ìƒì„± vs ê¸°ì¡´ ì»¨í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸                 â”‚
â”‚                                                             â”‚
â”‚  4. ì €ì¥                                                    â”‚
â”‚     â””â”€ íŒŒì¼ ìƒì„±/ìˆ˜ì • + registry ë“±ë¡                      â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Quick vs Deliberate ì°¨ì´

| ë‹¨ê³„ | Quick (Zero-Friction) | Deliberate |
|------|----------------------|------------|
| **1. Source** | í˜„ì¬ ì„¸ì…˜ (ì•”ë¬µì ) | ì‚¬ìš©ìê°€ ëª…ì‹œì  ì„ íƒ |
| **2. ì¶”ì¶œ** | AIê°€ ìë™ íŒë‹¨ | ì‚¬ìš©ìê°€ ë¦¬ë·°/ìˆ˜ì • |
| **3. ìœ„ì¹˜** | AI ì¶”ì²œ (1ê°œ) â†’ "ë§ì£ ?" | í›„ë³´ Nê°œ â†’ ì‚¬ìš©ì ì„ íƒ |
| **4. ìƒì„±/ì—…ë°ì´íŠ¸** | AI íŒë‹¨ â†’ ë°”ë¡œ ì‹¤í–‰ | ì‚¬ìš©ì í™•ì¸ í•„ìš” |
| **ë©”íƒ€ë°ì´í„°** | ìë™ ìƒì„± | í¸ì§‘ ê°€ëŠ¥ |
| **í™•ì¸** | ìµœì¢… 1íšŒ (Y/n) | ë‹¨ê³„ë³„ í™•ì¸ |

### ëª¨ë“œ ì„ íƒ ê¸°ì¤€

> **TODO: DISCUSS** - ê¸°ë³¸ê°’ ì „ëµ ë° êµ¬ì²´ì  UX ë…¼ì˜ í•„ìš”

| ìƒí™© | ì¶”ì²œ ëª¨ë“œ | ì´ìœ  |
|------|----------|------|
| ì„¸ì…˜ ì¢…ë£Œ ì‹œ ìë™ ì œì•ˆ | Quick | Passive Save |
| "ì´ê±° ì €ì¥í•´ì¤˜" í•œë§ˆë”” | Quick | ë§ˆì°° ìµœì†Œí™” |
| ì™¸ë¶€ ì†ŒìŠ¤ (Slack/URL) | Deliberate | ì†ŒìŠ¤ ì„ íƒ í•„ìš” |
| ê¸°ì¡´ ì»¨í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ | Deliberate | ì¶©ëŒ í™•ì¸ í•„ìš” |
| ë³µì¡í•œ êµ¬ì¡°í™” | Deliberate | ì •êµí•œ ì œì–´ í•„ìš” |

### Context Sources

ë‹¤ì–‘í•œ ì†ŒìŠ¤ì—ì„œ ì»¨í…ìŠ¤íŠ¸ ì¶”ì¶œ ê°€ëŠ¥:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Context Sources                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ğŸ’¬ Claude Code Session (ê¸°ë³¸ê°’)                            â”‚
â”‚     - í˜„ì¬ ì„¸ì…˜ì—ì„œ ìœ ì˜ë¯¸í•œ ë‚´ìš© ì¶”ì¶œ                     â”‚
â”‚     - Quick modeì˜ ì•”ë¬µì  ì†ŒìŠ¤                             â”‚
â”‚                                                             â”‚
â”‚  ğŸ’¼ Slack (MCP ì—°ë™)                                        â”‚
â”‚     - ì±„ë„/ìŠ¤ë ˆë“œì—ì„œ ì¶”ì¶œ                                 â”‚
â”‚                                                             â”‚
â”‚  ğŸ“‹ Clipboard                                               â”‚
â”‚     - í´ë¦½ë³´ë“œ ë‚´ìš©ì—ì„œ ì¶”ì¶œ                               â”‚
â”‚                                                             â”‚
â”‚  ğŸ”— URL                                                     â”‚
â”‚     - ì›¹í˜ì´ì§€ì—ì„œ ì¶”ì¶œ                                    â”‚
â”‚                                                             â”‚
â”‚  ğŸ“ ì§ì ‘ ì…ë ¥                                               â”‚
â”‚     - ì‚¬ìš©ìê°€ ìì—°ì–´ë¡œ ì…ë ¥                               â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Load í”Œë¡œìš°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Load Flow                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  [ìë™ ë¡œë“œ - Hook] â­ í•µì‹¬ ê°€ì¹˜                           â”‚
â”‚  íŠ¸ë¦¬ê±°: PostToolUse(Read) â†’ Hook Script                   â”‚
â”‚  ë°©ì‹: Path ê¸°ë°˜, Programmatic                             â”‚
â”‚  ëŒ€ìƒ: target í•„ë“œê°€ ìˆëŠ” contextë§Œ                        â”‚
â”‚                                                             â”‚
â”‚  Read("src/api.ts") í˜¸ì¶œ ì‹œ:                               â”‚
â”‚                                                             â”‚
â”‚  1. Hook Scriptê°€ stdinì—ì„œ file_path ì¶”ì¶œ                 â”‚
â”‚                                                             â”‚
â”‚  2. ctx load --file í˜¸ì¶œ                                   â”‚
â”‚     â†’ CLIê°€ registryì—ì„œ target ë§¤ì¹­                       â”‚
â”‚     â†’ ë§¤ì¹­ëœ context ê²½ë¡œ/ë©”íƒ€ë°ì´í„° JSON ë°˜í™˜             â”‚
â”‚                                                             â”‚
â”‚  3. Hook Scriptê°€ ê° context íŒŒì¼ ì½ê¸°                     â”‚
â”‚     â†’ ë‚´ìš© ì¡°í•©í•˜ì—¬ stdout ì¶œë ¥                            â”‚
â”‚     â†’ additionalContextë¡œ ì£¼ì…                             â”‚
â”‚                                                             â”‚
â”‚  ìš°ì„ ìˆœìœ„:                                                  â”‚
â”‚  1ìˆœìœ„: Project exact â†’ 2ìˆœìœ„: Global exact                â”‚
â”‚  3ìˆœìœ„: Project glob  â†’ 4ìˆœìœ„: Global glob                 â”‚
â”‚                                                             â”‚
â”‚  â€» target ì—†ëŠ” context â†’ Autoload ëŒ€ìƒ ì•„ë‹˜               â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  [ìˆ˜ë™ ë¡œë“œ - Skill] â­ ì‚¬ìš©ì ìš”ì²­ ê¸°ë°˜                   â”‚
â”‚  íŠ¸ë¦¬ê±°: "ì¸ì¦ ê´€ë ¨ ì»¨í…ìŠ¤íŠ¸ ì°¾ì•„ì¤˜" (ìì—°ì–´)              â”‚
â”‚         /ctx.load auth jwt (ëª…ì‹œì  í˜¸ì¶œ)                   â”‚
â”‚  ë°©ì‹: ctx-load Skill í™œì„±í™” â†’ ê²€ìƒ‰ â†’ Read                â”‚
â”‚                                                             â”‚
â”‚  "ì¸ì¦ ê´€ë ¨ ì»¨í…ìŠ¤íŠ¸ ë³´ì—¬ì¤˜" ìš”ì²­ ì‹œ:                      â”‚
â”‚  1. ctx-load Skill í™œì„±í™”                                  â”‚
â”‚  2. ctx status ì‹¤í–‰ â†’ context ëª©ë¡ í™•ì¸                   â”‚
â”‚  3. what í•„ë“œ ë³´ê³  ê´€ë ¨ context íŒë‹¨                       â”‚
â”‚  4. Read toolë¡œ ì§ì ‘ íŒŒì¼ ì½ê¸°                             â”‚
â”‚  5. ì‚¬ìš©ìì—ê²Œ context ë‚´ìš© ì œê³µ                          â”‚
â”‚                                                             â”‚
â”‚  â€» CLIì—ì„œ keyword search êµ¬í˜„ ì•ˆ í•¨                      â”‚
â”‚  â€» AI Skillì´ registry ì½ê³  íŒë‹¨í•˜ëŠ” ë°©ì‹                 â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Skills êµ¬ì¡°

```
plugin/skills/
â”œâ”€â”€ ctx-save/
â”‚   â””â”€â”€ SKILL.md              # Save Skill
â”‚       description: "ì»¨í…ìŠ¤íŠ¸ ì €ì¥, ì¶”ì¶œ, ê¸°ë¡ ìš”ì²­ ì‹œ í™œì„±í™”"
â”‚       - Quick/Deliberate ëª¨ë“œ ë¶„ê¸°
â”‚       - ë‹¤ì–‘í•œ source ì§€ì›
â”‚       - scope ì œì•ˆ + CLI create + ë‚´ìš© ì‘ì„±
â”‚
â”œâ”€â”€ ctx-load/
â”‚   â””â”€â”€ SKILL.md              # Load Skill
â”‚       description: "ì»¨í…ìŠ¤íŠ¸ ì¡°íšŒ, ê²€ìƒ‰, ë¡œë“œ ìš”ì²­ ì‹œ í™œì„±í™”"
â”‚       - ctx statusë¡œ ëª©ë¡ í™•ì¸
â”‚       - what í•„ë“œë¡œ ê´€ë ¨ context íŒë‹¨
â”‚       - Read toolë¡œ íŒŒì¼ ì½ì–´ì„œ ì œê³µ
â”‚
â””â”€â”€ commands/                  # Skillì˜ ëª…ì‹œì  ì§„ì…ì 
    â”œâ”€â”€ ctx.save.md           # /ctx.save â†’ ctx-save Skill í˜¸ì¶œ
    â””â”€â”€ ctx.load.md           # /ctx.load â†’ ctx-load Skill í˜¸ì¶œ
```

**ìë™ ë¡œë“œ vs ìˆ˜ë™ ë¡œë“œ**:
- ìë™ ë¡œë“œ: Hook Scriptê°€ `ctx load --file` í˜¸ì¶œ (íŒŒì¼ ì½ì„ ë•Œ ìë™)
- ìˆ˜ë™ ë¡œë“œ: `/ctx.load` Skillì´ ì‚¬ìš©ì ìš”ì²­ì— ë”°ë¼ context ê²€ìƒ‰/ë¡œë“œ

### CLI vs Skill ì—­í• 

| ë‹´ë‹¹ | CLI | Skill |
|------|-----|-------|
| íŒŒì¼ ìƒì„± | ctx create (í…œí”Œë¦¿) | - |
| ë‚´ìš© ì‘ì„± | - | Edit tool |
| Registry ë™ê¸°í™” | ctx sync | - |
| Scope ì œì•ˆ | - | AI ë¶„ì„ |
| ì‚¬ìš©ì ì¸í„°ë™ì…˜ | - | ìì—°ì–´ ëŒ€í™” |
| ê²€ì¦ | ctx check | - |
| ëª¨ë“œ ë¶„ê¸° (Quick/Deliberate) | - | AI íŒë‹¨ |

---

## 11. ì‹¤í–‰ ê³„íš

### Phase 1: ì •ë¦¬ ë° êµ¬ì¡° ë³€ê²½

1. **ì œê±° ì‘ì—…**
   - `src/templates/ai-commands/work/` ì „ì²´ ì‚­ì œ
   - issue_store ê´€ë ¨ ì½”ë“œ ì‚­ì œ
   - worktree ê´€ë ¨ ì½”ë“œ ì‚­ì œ
   - `.ctx.current` ê´€ë ¨ ì½”ë“œ ì‚­ì œ
   - **config.yaml ê´€ë ¨ ì½”ë“œ ì‚­ì œ**

2. **ë””ë ‰í† ë¦¬ êµ¬ì¡° ë³€ê²½**
   - `ctx/` â†’ `.ctx/` ë§ˆì´ê·¸ë ˆì´ì…˜ ë¡œì§
   - `ctx.config.yaml` â†’ ì‚­ì œ (config ì—†ìŒ)

3. **ì»¤ë§¨ë“œ ì •ë¦¬**
   - `ctx init` ìˆ˜ì • (Global Root ì´ˆê¸°í™”, registryë§Œ ìƒì„±)
   - `ctx init .` ì¶”ê°€ (Project ì´ˆê¸°í™”, registryë§Œ ìƒì„±)
   - `ctx add` / `ctx remove` ì¶”ê°€ (config íŒ¨í„´ ëŒ€ì²´)
   - work ê´€ë ¨ ì»¤ë§¨ë“œ ì œê±°

### Phase 2: Registry ë‹¨ì¼í™” êµ¬í˜„

1. **Global Root êµ¬í˜„**
   - `~/.ctx/` ë””ë ‰í† ë¦¬ ì§€ì›
   - **registry.yamlë§Œ ê´€ë¦¬ (config ì—†ìŒ!)**

2. **Context ì†Œì† ë¡œì§**
   - registry.yaml ì¡´ì¬ ì—¬ë¶€ë¡œ project íŒë‹¨
   - ìœ„ë¡œ íƒìƒ‰í•˜ì—¬ project ê²°ì •

3. **Registry í†µí•©**
   - ê¸°ì¡´ ë¶„ì‚° registry â†’ í•˜ì´ë¸Œë¦¬ë“œ registry ë§ˆì´ê·¸ë ˆì´ì…˜
   - ctx add/removeë¡œ ëª…ì‹œì  ë“±ë¡

### Phase 3: Plugin êµ¬ì¡°í™”

1. **Plugin ë””ë ‰í† ë¦¬ ìƒì„±**
   - `plugin/` ë””ë ‰í† ë¦¬ êµ¬ì¡°
   - plugin.json ì‘ì„±

2. **Skills êµ¬í˜„**
   - `/ctx.save` skill

3. **Hooks êµ¬í˜„**
   - PostToolUse(Read) ìë™ ë¡œë“œ hook
   - Hook Script (`auto-load-context.sh`)

4. **ì„¤ì¹˜ ì—°ë™**
   - `ctx init` ì‹œ plugin ì„¤ì¹˜ ì•ˆë‚´

### Phase 4: Load ìë™í™”

1. **PostToolUse hook êµ¬í˜„**
   - Read tool í˜¸ì¶œ ì‹œ companion context ìë™ ì£¼ì…
   - `.ctx.md` íŒŒì¼ì´ ìˆìœ¼ë©´ í•¨ê»˜ í‘œì‹œ

2. **Status ê°œì„ **
   - `ctx status` ì¶œë ¥ ê°œì„ 
   - what í•„ë“œë¡œ context ì„¤ëª… í‘œì‹œ

3. **SessionStart hook** (ì„ íƒì )
   - í”„ë¡œì íŠ¸ ì§„ì… ì‹œ í•µì‹¬ ì»¨í…ìŠ¤íŠ¸ ìš”ì•½

---

## 12. ê²°ë¡ 

### í•µì‹¬ ë³€ê²½ì‚¬í•­

| í•­ëª© | Before | After |
|------|--------|-------|
| Work workflow | 7ë‹¨ê³„ ë³µì¡í•œ íë¦„ | **ì™„ì „ ì œê±°** |
| Issue store | local/github/linear | **ì œê±°** |
| Worktree | ì§€ì› | **ì œê±°** |
| Config | `ctx.config.yaml` | **ì œê±° â†’ settingsë¡œ ìµœì†Œí™”** |
| Registry | ë¶„ì‚° (projectë§ˆë‹¤) | **í•˜ì´ë¸Œë¦¬ë“œ** (Global + Project) |
| Global | ì—†ìŒ | `~/.ctx/` (í•„ìˆ˜, Root, Git âŒ) |
| Project registry | ì—†ìŒ | `.ctx/registry.yaml` (Git âœ…) |
| Project init | ì•”ë¬µì  | `ctx init .` (registryë§Œ!) |
| Context ë“±ë¡ | config íŒ¨í„´ ìŠ¤ìº” | **`ctx add` ëª…ì‹œì  ë“±ë¡** |
| ì €ì¥ ìœ„ì¹˜ íŒë‹¨ | ì—†ìŒ | **`settings.context_paths`** (AI ì°¸ì¡°) |
| Save ì‹¤í–‰ | AIê°€ ì§ì ‘ íŒŒì¼ ì‘ì„± | CLI í…œí”Œë¦¿ + Skill ë‚´ìš© |
| íŒ€ í˜‘ì—… | ì œí•œì  | **Gitìœ¼ë¡œ registry ê³µìœ ** |
| Sync ë™ì‘ | Project ì—†ìœ¼ë©´ ì—ëŸ¬ | **ìŠ¤ë§ˆíŠ¸ Fallback** (Globalë¡œ) |
| Global Index | ìˆ˜ë™ (`--index`) | **ìë™ ì—…ë°ì´íŠ¸** (sync/add/create ì‹œ) |

### í•µì‹¬ ì›ì¹™

1. **Loadê°€ í•µì‹¬ì´ë‹¤**
   - ì»¨í…ìŠ¤íŠ¸ê°€ ìë™ìœ¼ë¡œ ëˆˆì•ì— ë‚˜íƒ€ë‚˜ì•¼ í•¨
   - ì‚¬ìš©ìê°€ "ë¡œë“œí•´ì•¼ì§€" ìƒê° ì•ˆ í•´ë„ ë˜ê²Œ

2. **ì €ì¥ì€ ìì—°ìŠ¤ëŸ½ê²Œ**
   - "ì´ê±° ì €ì¥í•´ë‘˜ë˜" í•œë§ˆë””ë©´ ë
   - Skillì´ scope ì œì•ˆ, CLIê°€ í…œí”Œë¦¿ ìƒì„±

3. **ë‹¨ìˆœí•¨ì´ ìµœìš°ì„ **
   - Work, issue store, worktree ëª¨ë‘ ì œê±°
   - **config.yaml ì œê±°** - registry.yaml í•˜ë‚˜ë¡œ ì¶©ë¶„
   - í•µì‹¬ ê¸°ëŠ¥(load, save, sync)ì— ì§‘ì¤‘

4. **ëª…ì‹œì  ë“±ë¡** (NEW)
   - config íŒ¨í„´ ìŠ¤ìº” ëŒ€ì‹  `ctx add`ë¡œ ëª…ì‹œì  ë“±ë¡
   - ì˜ë„ì¹˜ ì•Šì€ íŒŒì¼ ë“±ë¡ ë°©ì§€
   - ë“±ë¡ëœ ê²ƒë§Œ ê´€ë¦¬ (ì˜ˆì¸¡ ê°€ëŠ¥)

5. **ëª¨ë“  contextëŠ” ì†Œì†ì´ ìˆë‹¤**
   - project init ì•ˆ í•´ë„ context ìƒì„± ê°€ëŠ¥
   - ìœ„ë¡œ íƒìƒ‰ â†’ project ì—†ìœ¼ë©´ Global ì†Œì†
   - Orphan ì—†ìŒ

6. **ê°œì¸ + íŒ€ ëª¨ë‘ ì§€ì›**
   - Global registry: ê°œì¸ìš© (Git âŒ)
   - Project registry: íŒ€ ê³µìœ  (Git âœ…)
   - í˜¼ì ì¨ë„ ê°€ì¹˜, íŒ€ê³¼ ì¨ë„ ê°€ì¹˜

7. **ìŠ¤ë§ˆíŠ¸ Fallback** (NEW)
   - Project ì—†ëŠ” ê³³ì—ì„œë„ `ctx sync` ë™ì‘
   - ì—ëŸ¬ ëŒ€ì‹  ê²½ê³  + Global sync
   - ì–´ë””ì„œë“  ìì—°ìŠ¤ëŸ½ê²Œ ì‚¬ìš© ê°€ëŠ¥

8. **Global Index = ë³¸ì²´** (NEW)
   - "ëª¨ë“  contextë¥¼ ì•„ëŠ” ì¤‘ì•™ ì¸ë±ìŠ¤"
   - sync/add/create ì‹œ ìë™ ì—…ë°ì´íŠ¸
   - ì „ì—­ ê²€ìƒ‰ì˜ ì‹ ë¢°ì„± ë³´ì¥
   - Lazy update ëŒ€ì‹  ì„ ì œì  ê°±ì‹ 

### ì„±ê³µ ì§€í‘œ

- ì»¨í…ìŠ¤íŠ¸ ë¡œë“œë¥¼ "ì˜ì‹í•˜ì§€ ì•Šì•„ë„" ìë™ìœ¼ë¡œ ë¨
- ì €ì¥í•  ë•Œ "ì–´ë””ì—?" ê³ ë¯¼ ì•ˆ í•´ë„ ë¨
- CLI ì„¤ì¹˜ í›„ 5ë¶„ ë‚´ ì‚¬ìš© ê°€ëŠ¥
- í˜¼ì ì¨ë„ ê°€ì¹˜ë¥¼ ëŠë‚Œ
- `ctx status` í•œ ë²ˆì— ëª¨ë“  context íŒŒì•…
- **ì „ì—­ ê²€ìƒ‰ì´ í•­ìƒ ìµœì‹  ìƒíƒœ** - sync í›„ ë°”ë¡œ ë°˜ì˜ (NEW)
- **ì–´ë””ì„œë“  sync ê°€ëŠ¥** - Project ì—†ì–´ë„ ë™ì‘ (NEW)
- **ìƒˆ íŒ€ì› ì˜¨ë³´ë”©: cloneë§Œ í•˜ë©´ ì»¨í…ìŠ¤íŠ¸ ë°”ë¡œ ì‚¬ìš©**
- **CI/CDì—ì„œ ì»¨í…ìŠ¤íŠ¸ í™œìš© ê°€ëŠ¥**
